# Dynamic Root URI Deployment Plan for React App

## Objective
Enable deployment of the React app to multiple environments (custom domain and GitHub Pages) by passing the root URI as a build argument, avoiding hardcoded router basenames and broken links.

---

## Plan Outline

### 1. Problem Statement
- The app must work on both a custom domain (e.g., https://www.opendoorph.org/) and a subdirectory (e.g., https://p47phoenix.github.io/OpenDoorPH-website/).
- Hardcoding the router basename or asset paths causes broken links when switching environments.
- Need a flexible, maintainable solution for dynamic root URI configuration at build time.

### 2. Solution Approach
- Use a build argument (e.g., `ROOT_URI`) to set the router basename and asset paths.
- Inject the build argument via environment variables or build scripts.
- Configure the router and asset references to use the dynamic root URI.
- Document the process for maintainers and contributors.

### 3. Implementation Steps
1. **Build Argument Setup**
   - Define a build argument (e.g., `ROOT_URI`) in build scripts or CI/CD pipeline.
   - Pass this argument as an environment variable (e.g., `REACT_APP_ROOT_URI`).
2. **Router Configuration**
   - Set the router's `basename` prop to `process.env.REACT_APP_ROOT_URI`.
   - Fallback to `/` if not set.
3. **Static Asset Paths**
   - Reference static assets using the root URI variable to ensure correct paths.
   - Use relative paths or prepend the root URI as needed.
4. **Build Scripts**
   - Add npm scripts for each deployment target, setting the correct root URI.
   - Example: `npm run build:prod` for custom domain, `npm run build:gh-pages` for GitHub Pages.
5. **Documentation**
   - Document the workflow and environment variable usage for all contributors.

### 4. Example Workflow
- **Custom Domain Deployment:**
  - Set `REACT_APP_ROOT_URI=/` or leave unset for root domain.
  - Run `npm run build:prod`.
- **GitHub Pages Deployment:**
  - Set `REACT_APP_ROOT_URI=/OpenDoorPH-website/`.
  - Run `npm run build:gh-pages`.
  - Deploy `build/` to GitHub Pages.

### 5. Benefits
- No hardcoded paths in source code.
- Easy to switch between deployment targets.
- Reduces risk of broken links and routing issues.
- Clear, maintainable process for future updates.

---

## Next Steps
- Review and approve this plan.
- Implement build argument and environment variable support.
- Update router and asset references to use the dynamic root URI.
- Test deployments on both custom domain and GitHub Pages.
- Update documentation as needed.

---

*Generated by GitHub Copilot on August 8, 2025.*
